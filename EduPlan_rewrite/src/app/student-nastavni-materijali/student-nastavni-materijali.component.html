<div class="largeMedium" *ngIf="predmetNastavniMaterijali; else loader">
    <p-toast position="top-center"></p-toast>

    <ng-container>
        <a routerLink="/vStudentSviPredmeti" [title]="'PROFESOR-PREDMET_NATRAG' | translate">
            <img src="../../assets/layout/images/left.svg" alt="Go back" style="height: 2.5em; width: 3em;">
        </a>
        <div class="card card-w-title">
            <h1>
                <div class="ui-g ui-fluid">
                    <div class="ui-g-12">
                        <div class="ui-g-12 ui-lg-4 ui-md-4">
                            {{predmetNaziv}} &bull;
                            {{studijNaziv}}
                        </div>
                        <div class="ui-g-12 ui-lg-4 ui-md-4">
                            <span>
                                <i class="fa fa-search"></i>
                                <input type="text" pInputText size="30" placeholder="Search..."
                                    (input)="predmetMaterijaliSearch.filterGlobal($event.target.value, 'contains')"
                                    style="width:90%;">
                            </span>
                        </div>
                        <div class="ui-g-12 ui-lg-4 ui-md-4">
                            <p-menu [showTransitionOptions]="'0ms'" [hideTransitionOptions]="'0ms'"
                                #menuNastavniMaterijali [popup]="true" [model]="actionItemsNastavniMaterijali">
                            </p-menu>
                            <button type="button" pButton icon="fa fa-fw fa-list"
                                label="{{'PROFESOR_NASTAVNECJELINE_DOSTUPNEAKCIJE' | translate}}"
                                (click)="menuNastavniMaterijali.toggle($event)"
                                style="width: 50%; float: right;"></button>
                        </div>
                    </div>
                </div>
            </h1>

            <p-table #predmetMaterijaliSearch [value]="predmetNastavniMaterijali" [columns]="colsNastavniMaterijali"
                selectionMode="single" [scrollable]="true" scrollHeight="calc(100vh - 250px)"
                [(selection)]="selectedNastavniMaterijali" (onRowSelect)="onRowSelectNastavniMaterijali($event)"
                (onRowUnselect)="onRowUnselectNastavniMaterijali()">

                <!-- <ng-template pTemplate="colgroup" let-columns>
                        <colgroup>
                            <col *ngFor="let col of columns" [style.width]="col.width">
                        </colgroup>
                    </ng-template> -->

                <ng-template pTemplate="header" let-columns style="font-size: small;">
                    <tr>
                        <th *ngFor="let col of columns" [pSortableColumn]="col.field" style="text-align: center;"
                            pResizableColumn>
                            {{col.header}}
                            <p-sortIcon [field]="col.field"></p-sortIcon>
                        </th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex">
                    <tr [pSelectableRow]="rowData" [pSelectableRowIndex]="rowIndex">
                        <td *ngFor="let col of columns" class="ui-resizable-column" style="text-align: center;">

                            <span *ngIf="isPng(rowData[col.field]); else textOutput">
                                <img [src]="rowData[col.field]" [title]="showFileTypeTitle(rowData[col.field])">
                            </span>

                            <ng-template #textOutput>{{rowData[col.field]}}</ng-template>
                        </td>
                    </tr>
                </ng-template>

            </p-table>

        </div>
    </ng-container>
</div>

<div class="smallDevice"  *ngIf="predmetNastavniMaterijali; else loader">
        <ng-container>
                <p-table #predmetMaterijaliSearch  [value]="predmetNastavniMaterijali" [columns]="colsNastavniMaterijaliSmall"
                selectionMode="single" [scrollable]="true"  [(selection)]="selectedNastavniMaterijali" 
                (onRowSelect)="onRowSelectNastavniMaterijali($event)" (onRowUnselect)="onRowUnselectNastavniMaterijali()">
                    <ng-template pTemplate="caption">
                        <i class="fa fa-search"></i>
                        <input type="text" pInputText size="60"
                            placeholder="{{'PROFESOR_SVIPREDMETI_PREDMET_NASTAVNIMATERIJALI_UNESITENAZIV' | translate}}"
                            (input)="predmetMaterijaliSearch.filterGlobal($event.target.value, 'contains')"
                            style="width: 70%;">
                    </ng-template>

                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th *ngFor="let col of columns" [pSortableColumn]="col.field" pResizableColumn
                                style="text-align: center;">
                                {{col.header}}
                                <p-sortIcon [field]="col.field"></p-sortIcon>
                            </th>
                        </tr>
                    </ng-template>

                    <ng-template pTemplate="body" let-rowData let-expanded="expanded" let-columns="columns"
                        let-rowIndex="rowIndex">
                        <tr [pSelectableRow]="rowData" [pSelectableRowIndex]="rowIndex">
                            <td width="15%">
                                <a href="#" [pRowToggler]="rowData">
                                    <i [ngClass]="expanded ? 'pi pi-chevron-circle-down' : 'pi pi-chevron-circle-right'"
                                        style="font-size: 1.7em; margin-left: -0.3em;"></i>
                                </a>
                            </td>
                            <td *ngFor="let col of columns" class="ui-resizable-column" style="text-align: center;">
                                {{rowData[col.field]}}
                            </td>
                        </tr>
                    </ng-template>

                    <ng-template pTemplate="rowexpansion" let-rowData let-columns="columns">
                        <tr>
                            <td [attr.colspan]="columns.length + 1" class="ui-resizable-column">
                                <div class="card card-w-title">
                                    <h1 style="text-align: center;">
                                        {{'PROFESOR_SVIPREDMETI_PREDMET_NASTAVNIMATERIJALI_OPSIRNIJE' | translate}}
                                    </h1>
                                    <div class="ui-g">
                                        <div class="ui-lg-6 ui-md-6 ui-sm-12">
                                            <div class="ui-g">
                                                <div class="ui-g-12">
                                                    <b>
                                                        {{'NASTAVA_GRUPAPREDMETA_AKADEMSKAGODINA' | translate}}:
                                                    </b>
                                                    {{rowData.AkademskaGodina}}
                                                </div>

                                                <div class="ui-g-12">
                                                    <b>
                                                        {{'PROFESOR_SVIPREDMETI_PREDMET_NASTAVNIMATERIJALI_OZNAKADOKUMENTA' | translate}}:
                                                    </b>
                                                    {{rowData.OznakaDokumenta}}
                                                </div>

                                                <div class="ui-g-12">
                                                    <b>
                                                        {{'PREDMET_PREDMETMATERIJALI_OPIS' | translate}}:
                                                    </b>
                                                    {{rowData.Opis}}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="ui-g">
                                            <div class="ui-lg-6 ui-md-6 ui-sm-12">

                                                <div class="ui-g-12">
                                                    <b>
                                                        {{'PREDMET_PREDMETMATERIJALI_VIDLJIVO_STUDENTIMA' | translate}}:
                                                    </b>
                                                    <span
                                                        [style.color]="rowData.VidljivStudentimaDaNe == true ? 'green' : 'red' "><i
                                                            [ngClass]="rowData.VidljivStudentimaDaNe == true ? 'fa fa-fw fa-check' : 'fa fa-fw  fa-times'"></i>
                                                    </span>
                                                </div>

                                                <div class="ui-g-12">
                                                    <b>
                                                        {{'PROFESOR_SVIPREDMETI_PREDMET_NASTAVNIMATERIJALI_VELICINA' | translate}}:
                                                    </b>
                                                    {{rowData.size}}
                                                </div>

                                                <div class="ui-g-12">
                                                    <b>
                                                        {{'PROFESOR_SVIPREDMETI_PREDMET_NASTAVNIMATERIJALI_TIPDOKUMENTA' | translate}}:
                                                    </b>
                                                    <span>
                                                        <img [src]="rowData.imgSrc"
                                                            [title]="showFileTypeTitle(rowData.imgSrc)">
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </ng-container>
</div>

<ng-template #loader>
    <p-progressBar mode="indeterminate"></p-progressBar>
</ng-template>

<p-dialog [(visible)]="prikaziDatoteku" [modal]="true" [responsive]="true" [style]="{width: '600px'}" [positionTop]="20"
    [minY]="100" [baseZIndex]="10000" (onHide)="onClosePreview()">
    <div *ngIf="prikaziDatoteku" style="height: 600px; width: 100%;">
        <app-file-preview [data]="selectedNastavniMaterijali"></app-file-preview>
    </div>
</p-dialog>