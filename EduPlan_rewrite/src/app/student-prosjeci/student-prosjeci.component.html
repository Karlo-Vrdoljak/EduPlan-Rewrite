<div class="card largeMedium" style="padding: 10px!important;">
    <div *ngIf="subjects; else loader">
        <p-table [value]="subjects" dataKey="StudijskaGodina" [scrollable]="true" scrollHeight="80vh" sortField="StudijskaGodina" sortMode="single" (onSort)="onSort()">
        <ng-template pTemplate="caption">
            <!--Prosjeci--> 
            {{ 'STUDENT_PROSJECI_PROSJECI'  | translate }}
        </ng-template>
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th></th>
                <th>{{ 'STUDENT_PROSJECI_UPISANI_ECTS' | translate }}</th> <!--Upisani ECTS-->
                <th>{{ 'STUDENT_PROSJECI_POST_POLOZENIH_ECTS' | translate }}</th><!--Postotak položenih ECTS-->
                <th>{{ 'STUDENT_PROSJECI_POLOZENI_ECTS' | translate }}</th> <!--Položeni ECTS-->
                <th>{{ 'STUDENT_BDSTUDENTPODACINASTUDIJU_PROSJEK_OCJENA' | translate }}</th> <!--Prosjek ocjena-->
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex" let-expanded="expanded">
            <tr class="ui-widget-header" *ngIf="rowGroupData[rowData.StudijskaGodina].index === rowIndex">
                <td>
                    <a href="#" class="usesTransition fade" [pRowToggler]="rowData" style="text-align: center;">
                        <span class="groupAlign"><i [ngClass]="expanded ? 'pi pi-chevron-circle-right usesTransition fade' : 'pi pi-chevron-circle-down usesTransition fade'" style="margin-left:-0.2em;"></i>
                        {{rowData.StudijskaGodina}}&nbsp;godina</span>
                    </a>
                </td>
                <td style="text-align: center;">{{ _groupSubjects[rowData.StudijskaGodina]._sumEctsUpisano }}</td>
                <td style="text-align: center;">{{ _groupSubjects[rowData.StudijskaGodina]._avgECTS }}&nbsp;%</td>
                <td style="text-align: center;">{{ _groupSubjects[rowData.StudijskaGodina]._sumEctsPolozeno }}</td>
                <td style="text-align: center;">{{ _groupSubjects[rowData.StudijskaGodina]._avgOcjena }}</td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-columns="columns" let-rowData let-rowIndex="rowIndex">
        <td  colspan="5" class="ui-resizable-column" *ngIf="rowGroupData[rowData.StudijskaGodina].index === rowIndex">
            <div class="card" style="padding: 10px!important;" >
                <p-table [columns]="cols" [value]="subjects" [scrollable]="true" scrollHeight="30vh" [resizableColumns]="true">
                <ng-template pTemplate="colgroup" let-columns>
                    <colgroup>
                        <col *ngFor="let col of columns" >
                    </colgroup>
                </ng-template>
                <ng-template pTemplate="header" let-columns>
                    <tr>
                        <th *ngFor="let col of columns" pResizableColumn>
                            {{col.header}}
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-rowData let-columns="columns">
                    <tr *ngIf="rowGroupData[rowData.StudijskaGodina].index === rowIndex">
                        <td *ngFor="let col of columns" class="ui-resizable-column" style="text-align: center;">
                            <span *ngIf="isBoolean(rowData[col.field]); else textOutput">
                                <span [style.color]="rowData[col.field] == true ? 'green' : 'red' "><i
                                        [ngClass]="rowData[col.field] == true ? 'fa fa-fw fa-check' : 'fa fa-fw  fa-times'"></i></span>
                            </span>
                            <ng-template #textOutput>{{rowData[col.field]}}</ng-template>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            </div>
        </td>
        </ng-template>
        </p-table>
    </div>
</div>


<div class="card smallDevice" style="padding: 10px!important;">
    <div *ngIf="subjects; else loader">
        <p-table [value]="subjects" dataKey="StudijskaGodina" [scrollable]="true" scrollHeight="50vh" sortField="StudijskaGodina" sortMode="single" (onSort)="onSort()">
        <ng-template pTemplate="caption">
            <!--Prosjeci--> 
            {{ 'STUDENT_PROSJECI_PROSJECI'  | translate }}
        </ng-template>
        <ng-template pTemplate="header" let-columns>
            <tr>
                <!--<th>{{ 'STUDENT_PROSJECI_UPISANI_ECTS' | translate }}</th>-->
                <th colspan="2" style="text-align: center;" >{{ 'STUDENT_PROSJECI_POST_POLOZENIH_ECTS' | translate }}</th><!--Postotak položenih ECTS-->
                <!--<th>{{ 'STUDENT_PROSJECI_POLOZENI_ECTS' | translate }}</th>-->
                <th>{{ 'STUDENT_BDSTUDENTPODACINASTUDIJU_PROSJEK_OCJENA' | translate }}</th> <!--Prosjek ocjena-->
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex" let-expanded="expanded">
            <tr class="ui-widget-header" *ngIf="rowGroupData[rowData.StudijskaGodina].index === rowIndex">
                <td>
                    <a href="#" class="usesTransition fade" [pRowToggler]="rowData" style="text-align: center;">
                        <span class="groupAlign"><i [ngClass]="expanded ? 'pi pi-chevron-circle-right usesTransition fade' : 'pi pi-chevron-circle-down usesTransition fade'" style="margin-left:-0.2em;"></i>
                        {{rowData.StudijskaGodina}}&nbsp;god</span>
                    </a>
                </td>
                <!--<td style="text-align: center;">{{ _groupSubjects[rowData.StudijskaGodina -1 ]._sumEctsUpisano }}</td>-->
                <td style="text-align: center;">{{ _groupSubjects[rowData.StudijskaGodina]._avgECTS }}&nbsp;%</td>
                <!--<td style="text-align: center;">{{ _groupSubjects[rowData.StudijskaGodina -1 ]._sumEctsPolozeno }}</td>-->
                <td style="text-align: center;">{{ _groupSubjects[rowData.StudijskaGodina]._avgOcjena }}</td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-columns="columns" let-rowData let-rowIndex="rowIndex">
        <tr> <!--*ngIf="rowGroupData[rowData.StudijskaGodina].index === rowIndex"-->
            <td *ngIf="rowGroupData[rowData.StudijskaGodina].index === rowIndex"  colspan="3" class="ui-resizable-column" >
                <p-table [columns]="cols" [value]="subjects" [scrollable]="true" scrollHeight="60vh" [resizableColumns]="true">
                <!--{{col.header}} -->
                <ng-template pTemplate="body"  let-rowData let-columns="columns">
                    <p-accordion [multiple]="true" *ngIf="rowGroupData[rowData.StudijskaGodina].index === rowIndex">
                        <p-accordionTab  [header]="rowData['PredmetNaziv']">
                            <div *ngFor="let col of columns" >
                                <span *ngIf="col.field != 'PredmetNaziv'">
                                    <div class="ui-g">
                                        <div class="ui-g-12 ui-sm-6">
                                            <b style="padding: -10px!important; text-align: left;">{{ col.header }}</b>
                                        </div>
                                        <div style="text-align: center;" class="ui-g-12 ui-sm-6">
                                            <span *ngIf="isBoolean(rowData[col.field]); else textOutput">
                                                <span [style.color]="rowData[col.field] == true ? 'green' : 'red' "><i
                                                        [ngClass]="rowData[col.field] == true ? 'fa fa-fw fa-check' : 'fa fa-fw  fa-times'"></i></span>
                                            </span>
                                            <ng-template #textOutput>{{rowData[col.field]}}</ng-template>
                                        </div>
                                    </div>
                                </span>
                            </div>
                        </p-accordionTab>
                    </p-accordion>
                </ng-template>
            </p-table>
                
            </td>
        </tr>
        </ng-template>
        </p-table>
    </div>
</div>

<ng-template #loader>
    <p-progressBar mode="indeterminate"></p-progressBar>
</ng-template>

